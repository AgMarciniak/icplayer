<!doctype html>

<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>

    <title>Runtime test</title>
    
    <script type="text/javascript" language="javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" language="javascript" src="icplayer/icplayer.nocache.js"></script>
    
<script type="text/x-mathjax-config">
     MathJax.Hub.Config({
        TeX: {
            imageFont: null,
            extensions: ["mhchem.js"]
        }
    });
    </script>    
    <script language="javascript">
		var player1;
      	function icOnAppLoaded(){
	        // Load assessment
    	    player1 = icCreatePlayer('_icplayer');
    	    player1.setApiUrl('/player/api/123');
    	    //player1.setTestMode();
    	    //player1.setAnalyticsUrl('/analytics/presentation/add?pid=506&session=7e190a209bbaa831cf6d51eccb680ad1&');
			var page = parseInt(window.location.hash.substring(1), 10);
	        if (isNaN(page)) {
	        	page = page - 1;
	        } else {
	        	page = 0;
	        }        	
    		setPlayerState();
	        //player1.load('test/pages/main.xml');
	       	player1.load('content/default.ic.xml', page);
        	player1.onPageLoaded(function(){
        	});
      	}
      	
      	function testPlayerService(){
      		var ps = player1.getPlayerServices();
      		//alert(ps.getScore().getPageScore('ordering')['errorCount']);
      		alert("time: " + ps.getCommands().getTimeElapsed());
      	}
      
      	
      	var state;
      	function getPlayerState(){
      		if(typeof(Storage)=="undefined"){
      			alert('Local storage not implemented')
			}
      		else{
      			localStorage.state = player1.getState();
	      		console.log(state);
      		}
      	}
      
      	
      	function setPlayerState(){
      		if(localStorage.state){
      			player1.setState(localStorage.state);
      		}
      	}
    </script>
    
    <script type="text/javascript"
  		src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
    
  </head>

  <body>
	<div id="_icplayer"></div>
	<button onClick="testPlayerService()">Test Service</button>
	<button onClick="getPlayerState()">Save player state</button>
	<button onClick="setPlayerState()">Load player state</button>

  </body>
</html>

