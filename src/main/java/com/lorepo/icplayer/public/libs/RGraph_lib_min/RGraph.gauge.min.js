    /**
    * o------------------------------------------------------------------------------o
    * | This file is part of the RGraph package - you can learn more at:             |
    * |                                                                              |
    * |                          http://www.rgraph.net                               |
    * |                                                                              |
    * | This package is licensed under the RGraph license. For all kinds of business |
    * | purposes there is a small one-time licensing fee to pay and for non          |
    * | commercial  purposes it is free to use. You can read the full license here:  |
    * |                                                                              |
    * |                      http://www.rgraph.net/LICENSE.txt                       |
    * o------------------------------------------------------------------------------o
    */

"undefined"==typeof RGraph&&(RGraph={});
RGraph.Gauge=function(g,k,m,n){this.id=g;this.canvas=document.getElementById("object"===typeof g?g.id:g);this.context=this.canvas.getContext?this.canvas.getContext("2d"):null;this.canvas.__object__=this;this.type="gauge";this.min=k;this.max=m;this.value=n;this.isRGraph=!0;this.currentValue=null;this.uid=RGraph.CreateUID();this.canvas.uid=this.canvas.uid?this.canvas.uid:RGraph.CreateUID();this.colorsParsed=!1;this.coordsText=[];if("object"==typeof this.value)for(g=0;g<this.value.length;++g)this.value[g]>
this.max&&(this.value[g]=m),this.value[g]<this.min&&(this.value[g]=k);else if(this.value>this.max&&(this.value=m),this.value<this.min)this.value=k;RGraph.OldBrowserCompat(this.context);this.properties={"chart.angles.start":null,"chart.angles.end":null,"chart.centerx":null,"chart.centery":null,"chart.radius":null,"chart.gutter.left":15,"chart.gutter.right":15,"chart.gutter.top":15,"chart.gutter.bottom":15,"chart.border.width":10,"chart.title.top":"","chart.title.top.font":"Arial","chart.title.top.size":14,
"chart.title.top.color":"#333","chart.title.top.bold":!1,"chart.title.top.pos":null,"chart.title.bottom":"","chart.title.bottom.font":"Arial","chart.title.bottom.size":14,"chart.title.bottom.color":"#333","chart.title.bottom.bold":!1,"chart.title.bottom.pos":null,"chart.text.font":"Arial","chart.text.color":"#666","chart.text.size":10,"chart.background.color":"white","chart.background.gradient":!1,"chart.scale.decimals":0,"chart.scale.point":".","chart.scale.thousand":",","chart.units.pre":"","chart.units.post":"",
"chart.value.text":!1,"chart.value.text.y.pos":0.5,"chart.value.text.units.pre":null,"chart.value.text.units.post":null,"chart.red.start":0.9*this.max,"chart.red.color":"#DC3912","chart.yellow.color":"#FF9900","chart.green.end":0.7*this.max,"chart.green.color":"rgba(0,0,0,0)","chart.colors.ranges":null,"chart.needle.size":null,"chart.needle.tail":!1,"chart.needle.colors":["#D5604D","red","green","yellow"],"chart.needle.type":"triangle","chart.border.outer":"#ccc","chart.border.inner":"#f1f1f1","chart.border.outline":"black",
"chart.centerpin.color":"blue","chart.centerpin.radius":null,"chart.zoom.background":!0,"chart.zoom.action":"zoom","chart.tickmarks.small":25,"chart.tickmarks.small.color":"black","chart.tickmarks.medium":0,"chart.tickmarks.medium.color":"black","chart.tickmarks.big":5,"chart.tickmarks.big.color":"black","chart.labels.count":5,"chart.labels.centered":!1,"chart.labels.offset":0,"chart.border.gradient":!1,"chart.adjustable":!1,"chart.shadow":!0,"chart.shadow.color":"gray","chart.shadow.offsetx":0,"chart.shadow.offsety":0,
"chart.shadow.blur":15};this.canvas.__rgraph_aa_translated__||(this.context.translate(0.5,0.5),this.canvas.__rgraph_aa_translated__=!0);var f=RGraph,i=this.canvas,c=i.getContext("2d"),b=this.properties;this.Set=function(a,c){a=a.toLowerCase();a.substr(0,6)!="chart."&&(a="chart."+a);a=="chart.title"&&(a="chart.title.top");a=="chart.title.font"&&(a="chart.title.top.font");a=="chart.title.size"&&(a="chart.title.top.size");a=="chart.title.color"&&(a="chart.title.top.color");a=="chart.title.bold"&&(a=
"chart.title.top.bold");a=="chart.needle.color"&&(a="chart.needle.colors");b[a]=c;return this};this.Get=function(a){a.substr(0,6)!="chart."&&(a="chart."+a);a=="chart.needle.color"&&(a="chart.needle.colors");return b[a]};this.Draw=function(){f.FireCustomEvent(this,"onbeforedraw");this.currentValue=this.value;this.gutterLeft=b["chart.gutter.left"];this.gutterRight=b["chart.gutter.right"];this.gutterTop=b["chart.gutter.top"];this.gutterBottom=b["chart.gutter.bottom"];this.centerx=(i.width-this.gutterLeft-
this.gutterRight)/2+this.gutterLeft;this.centery=(i.height-this.gutterTop-this.gutterBottom)/2+this.gutterTop;this.radius=Math.min((i.width-this.gutterLeft-this.gutterRight)/2,(i.height-this.gutterTop-this.gutterBottom)/2);this.startAngle=b["chart.angles.start"]?b["chart.angles.start"]:HALFPI/3+HALFPI;this.endAngle=b["chart.angles.end"]?b["chart.angles.end"]:TWOPI+HALFPI-HALFPI/3;if(typeof b["chart.centerx"]=="number")this.centerx=b["chart.centerx"];if(typeof b["chart.centery"]=="number")this.centery=
b["chart.centery"];if(typeof b["chart.radius"]=="number")this.radius=b["chart.radius"];if(!this.colorsParsed){this.parseColors();this.colorsParsed=true}this.centerpinRadius=0.16*this.radius;if(typeof b["chart.centerpin.radius"]=="number")this.centerpinRadius=b["chart.centerpin.radius"];b["chart.contextmenu"]&&f.ShowContext(this);this.DrawBackGround();this.DrawGradient();this.DrawColorBands();this.DrawSmallTickmarks();this.DrawMediumTickmarks();this.DrawBigTickmarks();this.DrawLabels();this.DrawTopTitle();
this.DrawBottomTitle();if(typeof this.value=="object")for(var a=0;a<this.value.length;++a)this.DrawNeedle(this.value[a],b["chart.needle.colors"][a],a);else this.DrawNeedle(this.value,b["chart.needle.colors"][0],0);this.DrawCenterpin();b["chart.resizable"]&&f.AllowResizing(this);f.InstallEventListeners(this);f.FireCustomEvent(this,"ondraw");return this};this.DrawBackGround=function(){b["chart.shadow"]&&f.SetShadow(this,b["chart.shadow.color"],b["chart.shadow.offsetx"],b["chart.shadow.offsety"],b["chart.shadow.blur"]);
c.beginPath();c.fillStyle=b["chart.background.color"];c.arc(this.centerx,this.centery,this.radius,0,TWOPI,0);c.fill();f.NoShadow(this);var a=c.createRadialGradient(this.centerx+50,this.centery-50,0,this.centerx+50,this.centery-50,150);a.addColorStop(0,"#eee");a.addColorStop(1,"white");a=b["chart.border.width"];c.beginPath();c.fillStyle=b["chart.background.color"];c.arc(this.centerx,this.centery,this.radius,0,TWOPI,0);c.fill();c.beginPath();c.fillStyle=b["chart.border.outer"];c.arc(this.centerx,this.centery,
this.radius,0,TWOPI,0);c.fill();c.beginPath();c.fillStyle=b["chart.border.inner"];c.arc(this.centerx,this.centery,this.radius-a,0,TWOPI,0);c.fill();c.beginPath();c.fillStyle=b["chart.background.color"];c.arc(this.centerx,this.centery,this.radius-a-4,0,TWOPI,0);c.fill();c.beginPath();c.fillStyle=b["chart.background.color"];c.arc(this.centerx,this.centery,this.radius-a-4,0,TWOPI,0);c.fill();if(b["chart.background.gradient"]){c.beginPath();c.fillStyle=f.RadialGradient(this,this.centerx,this.centery,
0,this.centerx,this.centery,this.radius,"rgba(255,255,255,0.6)","rgba(255,255,255,0.1)");c.arc(this.centerx,this.centery,this.radius-a-4,0,TWOPI,0);c.fill()}c.beginPath();c.strokeStyle=b["chart.border.outline"];c.arc(this.centerx,this.centery,this.radius,0,TWOPI,0);c.stroke()};this.DrawSmallTickmarks=function(){var a=b["chart.tickmarks.small"];c.lineWidth=1;for(var d=0;d<=a;++d){c.beginPath();c.strokeStyle=b["chart.tickmarks.small.color"];var e=(this.endAngle-this.startAngle)/a*d+this.startAngle;
c.arc(this.centerx,this.centery,this.radius-b["chart.border.width"]-10,e,e+1E-5,0);c.arc(this.centerx,this.centery,this.radius-b["chart.border.width"]-10-5,e,e+1E-5,0);c.stroke()}};this.DrawMediumTickmarks=function(){if(b["chart.tickmarks.medium"]){var a=b["chart.tickmarks.medium"];c.lineWidth=3;c.lineCap="round";c.strokeStyle=b["chart.tickmarks.medium.color"];for(var d=0;d<=a;++d){c.beginPath();var e=(this.endAngle-this.startAngle)/a*d+this.startAngle+(this.endAngle-this.startAngle)/(2*a);if(e>this.startAngle&&
e<this.endAngle){c.arc(this.centerx,this.centery,this.radius-b["chart.border.width"]-10,e,e+1E-5,0);c.arc(this.centerx,this.centery,this.radius-b["chart.border.width"]-10-6,e,e+1E-5,0)}c.stroke()}}};this.DrawBigTickmarks=function(){var a=b["chart.tickmarks.big"];c.lineWidth=3;c.lineCap="round";for(var d=0;d<=a;++d){c.beginPath();c.strokeStyle=b["chart.tickmarks.big.color"];var e=(this.endAngle-this.startAngle)/a*d+this.startAngle;c.arc(this.centerx,this.centery,this.radius-b["chart.border.width"]-
10,e,e+1E-5,0);c.arc(this.centerx,this.centery,this.radius-b["chart.border.width"]-10-10,e,e+1E-5,0);c.stroke()}};this.DrawCenterpin=function(){var a=c.createRadialGradient(this.centerx+6,this.centery-6,0,this.centerx+6,this.centery-6,25);a.addColorStop(0,"#ddf");a.addColorStop(1,b["chart.centerpin.color"]);c.beginPath();c.fillStyle=a;c.arc(this.centerx,this.centery,this.centerpinRadius,0,TWOPI,0);c.fill()};this.DrawLabels=function(){c.fillStyle=b["chart.text.color"];var a=b["chart.text.font"],d=
b["chart.text.size"],e=b["chart.labels.specific"]?b["chart.labels.specific"].length-1:b["chart.labels.count"];c.beginPath();for(var g=0;g<=e;++g){var h=this.radius-25-b["chart.border.width"]-b["chart.labels.offset"],j=(this.endAngle-this.startAngle)/e,j=this.startAngle+g*j,j=j-HALFPI,i=this.centerx-Math.sin(j)*h,h=this.centery+Math.cos(j)*h,k=i>this.centerx?"right":"left",l=h>this.centery?"bottom":"top";j==HALFPI?l="center":j==PI?k="center":j==HALFPI+PI&&(l="center");if(b["chart.labels.centered"])l=
k="center";f.Text2(this,{font:a,size:d,x:i,y:h,text:b["chart.labels.specific"]?b["chart.labels.specific"][g]:f.number_format(this,((this.max-this.min)*(g/e)+this.min).toFixed(b["chart.scale.decimals"]),b["chart.units.pre"],b["chart.units.post"]),halign:k,valign:l,tag:b["chart.labels.specific"]?"labels.specific":"labels"})}c.fill();if(b["chart.value.text"]){i=this.centerx;h=this.centery+b["chart.value.text.y.pos"]*this.radius;e=typeof b["chart.value.text.units.pre"]=="string"?b["chart.value.text.units.pre"]:
b["chart.units.pre"];g=typeof b["chart.value.text.units.post"]=="string"?b["chart.value.text.units.post"]:b["chart.units.post"];f.Text2(this,{font:a,size:d+2,x:i,y:h,text:f.number_format(this,this.value.toFixed(b["chart.scale.decimals"]),e,g),halign:"center",valign:"center",bounding:true,boundingFill:"white",tag:"value.text"})}};this.DrawTopTitle=function(){var a=this.centerx,d=this.centery-25;typeof b["chart.title.top.pos"]=="number"&&(d=this.centery-this.radius*b["chart.title.top.pos"]);if(b["chart.title.top"]){c.fillStyle=
b["chart.title.top.color"];f.Text2(this,{font:b["chart.title.top.font"],size:b["chart.title.top.size"],x:a,y:d,text:String(b["chart.title.top"]),halign:"center",valign:"bottom",bold:b["chart.title.top.bold"],tag:"title.top"})}};this.DrawBottomTitle=function(){var a=this.centerx,d=this.centery+this.centerpinRadius+10;typeof b["chart.title.bottom.pos"]=="number"&&(d=this.centery+this.radius*b["chart.title.bottom.pos"]);if(b["chart.title.bottom"]){c.fillStyle=b["chart.title.bottom.color"];f.Text2(this,
{font:b["chart.title.bottom.font"],size:b["chart.title.bottom.size"],x:a,y:d,text:String(b["chart.title.bottom"]),halign:"center",valign:"top",bold:b["chart.title.bottom.bold"],tag:"title.bottom"})}};this.DrawNeedle=function(a,d,e){var f=b["chart.needle.type"];c.lineWidth=0.5;c.strokeStyle="gray";c.fillStyle=d;a=(this.endAngle-this.startAngle)*((a-this.min)/(this.max-this.min));a=a+this.startAngle;e=typeof b["chart.needle.size"]=="object"&&b["chart.needle.size"]&&typeof b["chart.needle.size"][e]==
"number"?b["chart.needle.size"][e]:typeof b["chart.needle.size"]=="number"?b["chart.needle.size"]:this.radius-25-b["chart.border.width"];if(f=="line"){c.beginPath();c.lineWidth=7;c.strokeStyle=d;c.arc(this.centerx,this.centery,e,a,a+1E-4,false);c.lineTo(this.centerx,this.centery);b["chart.needle.tail"]&&c.arc(this.centerx,this.centery,this.radius*0.2,a+PI,a+1E-5+PI,false);c.lineTo(this.centerx,this.centery);c.stroke()}else{c.beginPath();c.arc(this.centerx,this.centery,e,a,a+1E-5,false);c.arc(this.centerx,
this.centery,this.centerpinRadius*0.5,a+HALFPI,a+1E-5+HALFPI,false);b["chart.needle.tail"]&&c.arc(this.centerx,this.centery,this.radius*0.2,a+PI,a+1E-5+PI,false);c.arc(this.centerx,this.centery,this.centerpinRadius*0.5,a-HALFPI,a-1E-5-HALFPI,false);c.stroke();c.fill();this.angle=a}};this.DrawColorBands=function(){if(f.is_array(b["chart.colors.ranges"]))for(var a=b["chart.colors.ranges"],d=0;d<a.length;++d){c.fillStyle=a[d][2];c.lineWidth=0;c.beginPath();c.arc(this.centerx,this.centery,this.radius-
10-b["chart.border.width"],(a[d][0]-this.min)/(this.max-this.min)*(this.endAngle-this.startAngle)+this.startAngle,(a[d][1]-this.min)/(this.max-this.min)*(this.endAngle-this.startAngle)+this.startAngle,false);c.arc(this.centerx,this.centery,this.radius-20-b["chart.border.width"],(a[d][1]-this.min)/(this.max-this.min)*(this.endAngle-this.startAngle)+this.startAngle,(a[d][0]-this.min)/(this.max-this.min)*(this.endAngle-this.startAngle)+this.startAngle,true);c.closePath();c.fill()}else{c.strokeStyle=
b["chart.green.color"];c.fillStyle=b["chart.green.color"];d=this.startAngle;a=this.startAngle+(this.endAngle-this.startAngle)*((b["chart.green.end"]-this.min)/(this.max-this.min));c.beginPath();c.arc(this.centerx,this.centery,this.radius-10-b["chart.border.width"],d,a,false);c.arc(this.centerx,this.centery,this.radius-20-b["chart.border.width"],a,d,true);c.fill();c.strokeStyle=b["chart.yellow.color"];c.fillStyle=b["chart.yellow.color"];d=this.startAngle+(this.endAngle-this.startAngle)*((b["chart.red.start"]-
this.min)/(this.max-this.min));c.beginPath();c.arc(this.centerx,this.centery,this.radius-10-b["chart.border.width"],a,d,false);c.arc(this.centerx,this.centery,this.radius-20-b["chart.border.width"],d,a,true);c.fill();c.strokeStyle=b["chart.red.color"];c.fillStyle=b["chart.red.color"];a=this.startAngle+(this.endAngle-this.startAngle)*((this.max-this.min)/(this.max-this.min));c.beginPath();c.arc(this.centerx,this.centery,this.radius-10-b["chart.border.width"],d,a,false);c.arc(this.centerx,this.centery,
this.radius-20-b["chart.border.width"],a,d,true);c.fill()}};this.getShape=function(){};this.getValue=function(a){a=f.getMouseXY(a);a=f.getAngleByXY(this.centerx,this.centery,a[0],a[1]);a>=0&&a<=HALFPI&&(a=a+TWOPI);a=(a-this.startAngle)/(this.endAngle-this.startAngle)*(this.max-this.min);a=a+this.min;if(a<this.min)a=this.min;if(a>this.max)a=this.max;return a};this.getObjectByXY=function(a){a=RGraph.getMouseXY(a);if(a[0]>this.centerx-this.radius&&a[0]<this.centerx+this.radius&&a[1]>this.centery-this.radius&&
a[1]<this.centery+this.radius&&f.getHypLength(this.centerx,this.centery,a[0],a[1])<=this.radius)return this};this.DrawGradient=function(){if(b["chart.border.gradient"]){c.beginPath();var a=c.createRadialGradient(this.centerx,this.centery,this.radius,this.centerx,this.centery,this.radius-15);a.addColorStop(0,"gray");a.addColorStop(1,"white");c.fillStyle=a;c.arc(this.centerx,this.centery,this.radius,0,TWOPI,false);c.arc(this.centerx,this.centery,this.radius-15,TWOPI,0,true);c.fill()}};this.Adjusting_mousemove=
function(a){if(b["chart.adjustable"]&&f.Registry.Get("chart.adjusting")&&f.Registry.Get("chart.adjusting").uid==this.uid){this.value=this.getValue(a);f.Clear(this.canvas);f.RedrawCanvas(this.canvas);f.FireCustomEvent(this,"onadjust")}};this.getAngle=function(a){return a>this.max||a<this.min?null:(a-this.min)/(this.max-this.min)*(this.endAngle-this.startAngle)+this.startAngle};this.parseColors=function(){b["chart.background.color"]=this.parseSingleColorForGradient(b["chart.background.color"]);b["chart.red.color"]=
this.parseSingleColorForGradient(b["chart.red.color"]);b["chart.yellow.color"]=this.parseSingleColorForGradient(b["chart.yellow.color"]);b["chart.green.color"]=this.parseSingleColorForGradient(b["chart.green.color"]);b["chart.border.inner"]=this.parseSingleColorForGradient(b["chart.border.inner"]);b["chart.border.outer"]=this.parseSingleColorForGradient(b["chart.border.outer"]);if(b["chart.colors.ranges"])for(var a=b["chart.colors.ranges"],c=0;c<a.length;++c)a[c][2]=this.parseSingleColorForGradient(a[c][2]);
if(b["chart.needle.colors"]){a=b["chart.needle.colors"];for(c=0;c<a.length;++c)a[c]=this.parseSingleColorForGradient(a[c])}};this.parseSingleColorForGradient=function(a){if(!a||typeof a!="string")return a;if(a.match(/^gradient\((.*)\)$/i)){var b=RegExp.$1.split(":"),e=c.createRadialGradient(this.centerx,this.centery,0,this.centerx,this.centery,this.radius),g=1/(b.length-1);e.addColorStop(0,f.trim(b[0]));for(var h=1;h<b.length;++h)e.addColorStop(h*g,f.trim(b[h]))}return e?e:a};f.Register(this)};
